# Compact IIS & .NET Validation Script

Import-Module WebAdministration
$checks = @()

# IIS & Services
$checks += [pscustomobject]@{Check="IIS Console"; Status=if((Get-WindowsFeature Web-Mgmt-Console).Installed){"Installed"}else{"Missing"}}
$checks += [pscustomobject]@{Check="WAS Service"; Status=if((Get-Service WAS -ErrorAction SilentlyContinue).Status -eq 'Running'){"Running"}else{"Stopped"}}
$checks += [pscustomobject]@{Check="W3SVC Service"; Status=if((Get-Service W3SVC -ErrorAction SilentlyContinue).Status -eq 'Running'){"Running"}else{"Stopped"}}

# .NET 4.8
$net48 = (Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full" -ErrorAction SilentlyContinue).Release
$checks += [pscustomobject]@{Check=".NET 4.8"; Status=if($net48 -ge 528040){"Installed"}else{"Missing"}}

# IIS Paths
$inetsrv = "$env:SystemRoot\System32\inetsrv"
$checks += [pscustomobject]@{Check="IIS Path"; Status=if(Test-Path $inetsrv){"Exists"}else{"Missing"}; Path=$inetsrv}

# Default Website & App Pool
$site = Get-Website "Default Web Site" -ErrorAction SilentlyContinue
$checks += [pscustomobject]@{Check="Default Website"; Status=if($site){"Present"}else{"Missing"}; Path=if($site){$site.physicalPath}else{"N/A"}}
$checks += [pscustomobject]@{Check="Default App Pool"; Status=if(Test-Path "IIS:\AppPools\DefaultAppPool"){"Present"}else{"Missing"}}

# IIS Log Path
$logPath = if($site){$site.logFile.directory}else{"N/A"}
$checks += [pscustomobject]@{Check="IIS Log Path"; Status=if($logPath -ne "N/A"){"Exists"}else{"N/A"}; Path=$logPath}

# QUAL.HTML accessibility
try{$resp=Invoke-WebRequest "http://localhost/QUAL.HTML" -UseBasicParsing -ErrorAction Stop;$status="Accessible"}catch{$status="Not Accessible"}
$checks += [pscustomobject]@{Check="QUAL.HTML Page"; Status=$status; Path="http://localhost/QUAL.HTML"}

# Display table
$checks | Format-Table -AutoSize
